INFO:root:Namespace(model_name='Dcrec', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-05 19:35:53 ---------------------------------------------
INFO:root:
===========================================
 Arguments          | Values               
===========================================
 batch_size         | 256                 
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0.2                 
 early_stop         | 10                  
 epoch              | 20                  
 eval_batch_size    | 256                 
 gpu                | 0                   
 history_max        | 20                  
 l2                 | 0                   
 lr                 | 0.0026              
 main_metric        |                     
 num_neg            | 1                   
 num_workers        | 0                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 topk               | 5,10,20,50          
===========================================
INFO:root:Device: cuda
INFO:root:Load corpus from ..\data\Grocery_and_Gourmet_Food\DcrecReader.pkl
INFO:root:Namespace(model_name='Dcrec', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-05 19:36:46 ---------------------------------------------
INFO:root:
===========================================
 Arguments          | Values               
===========================================
 batch_size         | 256                 
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0.2                 
 early_stop         | 10                  
 epoch              | 20                  
 eval_batch_size    | 256                 
 gpu                | 0                   
 history_max        | 20                  
 l2                 | 0                   
 lr                 | 0.0026              
 main_metric        |                     
 num_neg            | 1                   
 num_workers        | 0                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 topk               | 5,10,20,50          
===========================================
INFO:root:Device: cuda
INFO:root:Load corpus from ..\data\Grocery_and_Gourmet_Food\DcrecReader.pkl
INFO:root:#params: 673536
INFO:root:Dcrec(
  (emb_layer): TransformerEmbedding(
    (token_emb): Embedding(8715, 64, padding_idx=0)
    (position_emb): Embedding(50, 64)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_layers): ModuleList(
    (0): TransformerLayer(
      (attention): MultiHeadAttention(
        (linear_layers): ModuleList(
          (0): Linear(in_features=64, out_features=64, bias=True)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): Linear(in_features=64, out_features=64, bias=True)
        )
        (output_linear): Linear(in_features=64, out_features=64, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (feed_forward): PositionwiseFeedForward(
        (w_1): Linear(in_features=64, out_features=256, bias=True)
        (w_2): Linear(in_features=256, out_features=64, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (activation): GELU(approximate=none)
      )
      (input_sublayer): ResidualConnection(
        (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (output_sublayer): ResidualConnection(
        (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (1): TransformerLayer(
      (attention): MultiHeadAttention(
        (linear_layers): ModuleList(
          (0): Linear(in_features=64, out_features=64, bias=True)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): Linear(in_features=64, out_features=64, bias=True)
        )
        (output_linear): Linear(in_features=64, out_features=64, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (feed_forward): PositionwiseFeedForward(
        (w_1): Linear(in_features=64, out_features=256, bias=True)
        (w_2): Linear(in_features=256, out_features=64, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (activation): GELU(approximate=none)
      )
      (input_sublayer): ResidualConnection(
        (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (output_sublayer): ResidualConnection(
        (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
  (loss_fct): CrossEntropyLoss()
  (dropout): Dropout(p=0.1, inplace=False)
  (layernorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (contrastive_learning_layer): CLLayer(
    (fc1): Linear(in_features=64, out_features=64, bias=True)
    (fc2): Linear(in_features=64, out_features=64, bias=True)
  )
  (gcn): LightGCN(
    (layers): ModuleList(
      (0): GraphConv(in=64, out=64, normalization=both, activation=None)
      (1): GraphConv(in=64, out=64, normalization=both, activation=None)
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.0432,NDCG@5:0.0251,HR@10:0.0913,NDCG@10:0.0404,HR@20:0.1911,NDCG@20:0.0653,HR@50:0.5031,NDCG@50:0.1261)
INFO:root:Optimizer: Adam
INFO:root: test=(HR@5:0.2979,NDCG@5:0.2138,HR@10:0.3785,NDCG@10:0.2398,HR@20:0.4827,NDCG@20:0.2660,HR@50:0.6868,NDCG@50:0.3061) [1.0 s]
INFO:root: test=(HR@5:0.3306,NDCG@5:0.2480,HR@10:0.4098,NDCG@10:0.2736,HR@20:0.5046,NDCG@20:0.2974,HR@50:0.6942,NDCG@50:0.3347) [1.0 s]
INFO:root: test=(HR@5:0.3402,NDCG@5:0.2595,HR@10:0.4190,NDCG@10:0.2849,HR@20:0.5197,NDCG@20:0.3102,HR@50:0.7129,NDCG@50:0.3481) [1.1 s]
INFO:root: test=(HR@5:0.3412,NDCG@5:0.2567,HR@10:0.4223,NDCG@10:0.2829,HR@20:0.5241,NDCG@20:0.3086,HR@50:0.7245,NDCG@50:0.3480) [1.0 s]
INFO:root: test=(HR@5:0.3618,NDCG@5:0.2767,HR@10:0.4423,NDCG@10:0.3027,HR@20:0.5464,NDCG@20:0.3289,HR@50:0.7328,NDCG@50:0.3656) [1.0 s]
INFO:root: test=(HR@5:0.3719,NDCG@5:0.2855,HR@10:0.4512,NDCG@10:0.3110,HR@20:0.5480,NDCG@20:0.3353,HR@50:0.7378,NDCG@50:0.3726) [1.2 s]
INFO:root: test=(HR@5:0.3769,NDCG@5:0.2870,HR@10:0.4616,NDCG@10:0.3142,HR@20:0.5664,NDCG@20:0.3407,HR@50:0.7704,NDCG@50:0.3809) [1.0 s]
INFO:root: test=(HR@5:0.3861,NDCG@5:0.2972,HR@10:0.4713,NDCG@10:0.3247,HR@20:0.5773,NDCG@20:0.3514,HR@50:0.7709,NDCG@50:0.3895) [1.0 s]
INFO:root: test=(HR@5:0.3893,NDCG@5:0.2976,HR@10:0.4763,NDCG@10:0.3257,HR@20:0.5816,NDCG@20:0.3522,HR@50:0.7732,NDCG@50:0.3902) [1.1 s]
INFO:root: test=(HR@5:0.3943,NDCG@5:0.3016,HR@10:0.4793,NDCG@10:0.3290,HR@20:0.5831,NDCG@20:0.3551,HR@50:0.7773,NDCG@50:0.3934) [1.1 s]
INFO:root: test=(HR@5:0.3954,NDCG@5:0.3043,HR@10:0.4789,NDCG@10:0.3312,HR@20:0.5877,NDCG@20:0.3586,HR@50:0.7832,NDCG@50:0.3972) [1.0 s]
INFO:root: test=(HR@5:0.3929,NDCG@5:0.3031,HR@10:0.4764,NDCG@10:0.3301,HR@20:0.5818,NDCG@20:0.3566,HR@50:0.7876,NDCG@50:0.3972) [1.0 s]
INFO:root: test=(HR@5:0.3938,NDCG@5:0.3025,HR@10:0.4805,NDCG@10:0.3305,HR@20:0.5837,NDCG@20:0.3565,HR@50:0.7822,NDCG@50:0.3956) [1.1 s]
INFO:root: test=(HR@5:0.3896,NDCG@5:0.2990,HR@10:0.4725,NDCG@10:0.3258,HR@20:0.5833,NDCG@20:0.3537,HR@50:0.7905,NDCG@50:0.3945) [1.1 s]
INFO:root: test=(HR@5:0.3970,NDCG@5:0.3062,HR@10:0.4834,NDCG@10:0.3340,HR@20:0.5916,NDCG@20:0.3613,HR@50:0.7893,NDCG@50:0.4002) [1.1 s]
INFO:root: test=(HR@5:0.3923,NDCG@5:0.3034,HR@10:0.4850,NDCG@10:0.3334,HR@20:0.5893,NDCG@20:0.3596,HR@50:0.7923,NDCG@50:0.3996) [1.0 s]
INFO:root: test=(HR@5:0.3960,NDCG@5:0.3036,HR@10:0.4822,NDCG@10:0.3315,HR@20:0.5916,NDCG@20:0.3591,HR@50:0.7943,NDCG@50:0.3991) [1.2 s]
INFO:root: test=(HR@5:0.3954,NDCG@5:0.3041,HR@10:0.4862,NDCG@10:0.3334,HR@20:0.5971,NDCG@20:0.3613,HR@50:0.7968,NDCG@50:0.4007) [1.0 s]
INFO:root: test=(HR@5:0.3913,NDCG@5:0.3038,HR@10:0.4861,NDCG@10:0.3343,HR@20:0.5991,NDCG@20:0.3629,HR@50:0.8006,NDCG@50:0.4027) [1.0 s]
INFO:root: test=(HR@5:0.3932,NDCG@5:0.3036,HR@10:0.4836,NDCG@10:0.3329,HR@20:0.5938,NDCG@20:0.3607,HR@50:0.7965,NDCG@50:0.4007) [1.0 s]
INFO:root:
Dev  After Training: (HR@5:0.4380,NDCG@5:0.3453,HR@10:0.5261,NDCG@10:0.3737,HR@20:0.6303,NDCG@20:0.3999,HR@50:0.8187,NDCG@50:0.4370)
INFO:root:
Test After Training: (HR@5:0.3932,NDCG@5:0.3036,HR@10:0.4835,NDCG@10:0.3329,HR@20:0.5938,NDCG@20:0.3607,HR@50:0.7965,NDCG@50:0.4007)
INFO:root:Saving top-100 recommendation results to: ../log/Dcrec\Dcrec__Grocery_and_Gourmet_Food__0__lr=0\rec-Dcrec-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/Dcrec\Dcrec__Grocery_and_Gourmet_Food__0__lr=0\rec-Dcrec-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-05 20:02:11 ---------------------------------------------
